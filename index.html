<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Telescope IO</title>
    <style type="text/css">
      * {
        box-sizing: border-box;
      }
      body {
        font-family: Helvetica, Arial, Sans Serif;
      }
      p {
        line-height: 20px;
        color: #333;
      }
      .container {
        height: 1800px;
        width: 500px;
        margin: 100px auto;
      }

      .animated-text {
        font-size: 30px;
        text-align: center;
        opacity: 0;
        transform: translateY(100px);
        transition: opacity 1s ease, transform 1s ease;
      }

      .animated-text.visible {
        opacity: 1;
        transform: translateX(0);
      }
    </style>
  </head>
  <body>
    <section class="container">
      <h1>Example 1</h1>
      <p>
        Scroll to the bottom of the page. The text will transition in when it
        becomes visible in the viewport.
      </p>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse
        vestibulum purus non porta ullamcorper. Vivamus tempus, massa in posuere
        tincidunt, lorem purus porta est, viverra tristique ipsum eros vitae
        metus. Suspendisse sagittis neque eget finibus gravida. Etiam sem urna,
        pulvinar eu mattis ut, sodales non massa. Morbi viverra luctus
        convallis. Curabitur ac massa mauris. Curabitur ut scelerisque nunc.
        Nulla condimentum porttitor est ac varius. Sed vel dui sed enim rutrum
        faucibus vitae eu eros. Curabitur eros leo, euismod ac ante eu, viverra
        malesuada diam.
      </p>

      <p>
        Nullam quis ipsum sagittis augue imperdiet fermentum. Morbi dapibus
        metus tempus, ullamcorper sem sit amet, dignissim felis. Curabitur arcu
        nulla, mattis hendrerit gravida at, sodales et lectus. Phasellus id
        porta quam. Sed in ex posuere, molestie mi eu, accumsan lectus. Cras
        erat massa, mollis vitae varius vel, hendrerit sit amet mi. Etiam nisl
        leo, sollicitudin non orci vel, lobortis consectetur metus. Sed cursus
        quam sapien, vehicula pharetra quam malesuada a. Curabitur in molestie
        arcu. Mauris nec leo venenatis, pulvinar lectus vel, convallis nibh.
        Aliquam a tellus eu metus hendrerit ultrices at blandit dolor. Praesent
        pharetra enim quis nunc bibendum, eu facilisis lacus auctor. Aliquam
        erat volutpat.
      </p>

      <p>
        Nam rhoncus vel erat et efficitur. Proin iaculis molestie erat, at
        sagittis enim finibus non. Aliquam tempus elit sit amet leo porta, a
        porttitor erat consequat. Praesent faucibus odio vitae purus pharetra
        aliquet. Fusce sit amet interdum ante. Sed tempor, purus quis porttitor
        ornare, quam purus dapibus neque, dapibus vulputate lorem ex nec elit.
        Maecenas in auctor mi, id sodales massa. Sed orci tellus, vestibulum et
        euismod iaculis, egestas vitae nulla. Nam a ornare ex, in semper nisl.
        Aliquam venenatis tortor arcu. Integer suscipit porta arcu.
      </p>

      <p>
        Aliquam eu nibh diam. Aliquam non cursus leo. Curabitur facilisis lacus
        ut nisi fringilla feugiat. Maecenas augue purus, pretium a magna non,
        auctor finibus justo. Fusce imperdiet libero ac quam elementum, vel
        vehicula nibh malesuada. Aliquam rhoncus quis nunc id aliquet. Duis ac
        finibus nisi. Donec fringilla tempor nibh ac tempor. Morbi a lectus vel
        tellus tincidunt posuere ut vel nisi. Proin aliquam ex libero, congue
        accumsan augue eleifend in. Nam sit amet dictum ipsum.
      </p>

      <p>
        Nulla eu ipsum ultricies, gravida elit quis, egestas urna. Orci varius
        natoque penatibus et magnis dis parturient montes, nascetur ridiculus
        mus. Proin blandit porta sem, eget lobortis sem pellentesque sit amet.
        Proin porttitor felis non tempus rhoncus. Cras lobortis accumsan nisi,
        at faucibus nibh laoreet quis. Vestibulum nisl urna, ullamcorper ut urna
        nec, venenatis consectetur massa. Aliquam erat volutpat. Maecenas
        facilisis diam eget consectetur elementum. Etiam magna mauris, vulputate
        quis gravida ut, tristique vel orci. Mauris condimentum nibh felis, ut
        feugiat dolor sodales vel. Pellentesque non iaculis sem, vel ullamcorper
        tellus. Nam dictum accumsan metus sed imperdiet. Phasellus malesuada
        nisl urna, quis consectetur nibh elementum ac. Nulla vitae dolor quis
        turpis pellentesque molestie a quis mauris. Integer enim leo, tincidunt
        vel leo sed, consequat finibus dolor. Phasellus elit libero, cursus non
        orci quis, suscipit rhoncus quam.
      </p>

      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse
        vestibulum purus non porta ullamcorper. Vivamus tempus, massa in posuere
        tincidunt, lorem purus porta est, viverra tristique ipsum eros vitae
        metus. Suspendisse sagittis neque eget finibus gravida. Etiam sem urna,
        pulvinar eu mattis ut, sodales non massa. Morbi viverra luctus
        convallis. Curabitur ac massa mauris. Curabitur ut scelerisque nunc.
        Nulla condimentum porttitor est ac varius. Sed vel dui sed enim rutrum
        faucibus vitae eu eros. Curabitur eros leo, euismod ac ante eu, viverra
        malesuada diam.
      </p>
      <p>
        Nullam quis ipsum sagittis augue imperdiet fermentum. Morbi dapibus
        metus tempus, ullamcorper sem sit amet, dignissim felis. Curabitur arcu
        nulla, mattis hendrerit gravida at, sodales et lectus. Phasellus id
        porta quam. Sed in ex posuere, molestie mi eu, accumsan lectus. Cras
        erat massa, mollis vitae varius vel, hendrerit sit amet mi. Etiam nisl
        leo, sollicitudin non orci vel, lobortis consectetur metus. Sed cursus
        quam sapien, vehicula pharetra quam malesuada a. Curabitur in molestie
        arcu. Mauris nec leo venenatis, pulvinar lectus vel, convallis nibh.
        Aliquam a tellus eu metus hendrerit ultrices at blandit dolor. Praesent
        pharetra enim quis nunc bibendum, eu facilisis lacus auctor. Aliquam
        erat volutpat.
      </p>

      <p>
        Nam rhoncus vel erat et efficitur. Proin iaculis molestie erat, at
        sagittis enim finibus non. Aliquam tempus elit sit amet leo porta, a
        porttitor erat consequat. Praesent faucibus odio vitae purus pharetra
        aliquet. Fusce sit amet interdum ante. Sed tempor, purus quis porttitor
        ornare, quam purus dapibus neque, dapibus vulputate lorem ex nec elit.
        Maecenas in auctor mi, id sodales massa. Sed orci tellus, vestibulum et
        euismod iaculis, egestas vitae nulla. Nam a ornare ex, in semper nisl.
        Aliquam venenatis tortor arcu. Integer suscipit porta arcu.
      </p>
      <h2 class="animated-text">Animated Text</h2>
    </section>
    <p>
      Nullam quis ipsum sagittis augue imperdiet fermentum. Morbi dapibus metus
      tempus, ullamcorper sem sit amet, dignissim felis. Curabitur arcu nulla,
      mattis hendrerit gravida at, sodales et lectus. Phasellus id porta quam.
      Sed in ex posuere, molestie mi eu, accumsan lectus. Cras erat massa,
      mollis vitae varius vel, hendrerit sit amet mi. Etiam nisl leo,
      sollicitudin non orci vel, lobortis consectetur metus. Sed cursus quam
      sapien, vehicula pharetra quam malesuada a. Curabitur in molestie arcu.
      Mauris nec leo venenatis, pulvinar lectus vel, convallis nibh. Aliquam a
      tellus eu metus hendrerit ultrices at blandit dolor. Praesent pharetra
      enim quis nunc bibendum, eu facilisis lacus auctor. Aliquam erat volutpat.
    </p>
    <script type="text/javascript">
      // target is a querySelector that is passed in to observerVisualizer
      const target = document.querySelector(".animated-text");

      // target has different styles applied to it. Whatever we can get from the observer
      // for text color? #333333;
      // target location on screen:
      //   target.style.border = "1px solid green";
      //   target.style.backgroundColor = "yellow";
      //   target.style.opacity = "0.2";
      // observer/options values

      const options = {
        root: null,
        rootMargin: "0px",
        threshold: 0.75,
      };
      console.log("options: ", options);

      function handleIntersection(entries) {
        entries.map((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("visible");
            //TODO:

            console.log("entry: ", entry);
            console.log(entry.boundingClientRect);
            const x = entry.boundingClientRect.x;
            const y = entry.boundingClientRect.y;
            const width = entry.boundingClientRect.width;
            const height = entry.boundingClientRect.height;
            const top = entry.boundingClientRect.top;
            const left = entry.boundingClientRect.left;
            // const myDOMRect = new DOMRect(x, y, width, height);
            // console.log("myDOMRect: ", myDOMRect);

            // target is the box
            const box = document.createElement("div");
            box.style.position = "absolute";
            box.style.top = "0px";
            box.style.left = "0px";
            box.style.width = width + "px";
            box.style.height = height + "px";

            box.style.border = "1px solid #DD3C10";
            box.style.backgroundColor = "#FFEBE8";
            box.style.zIndex = "-9999999999";
            // TODO: make onHover for the target element ... maybe have the threshold value be in a dotted line and user chooses color. And when
            // hovering over controller the threshold definition from MDN comes up...
            console.log(box);
            entry.target.appendChild(box);

            // threshold line 1
            const thresholdValue = options.threshold;
            const thresholdLine1 = document.createElement("div");
            thresholdLine1.style.position = "absolute";
            thresholdLine1.style.top = thresholdValue * 100 + "%";
            thresholdLine1.style.left = "0px";
            thresholdLine1.style.borderTop = "1px dotted red";
            thresholdLine1.style.height = "1px";
            thresholdLine1.style.width = "100%";
            box.appendChild(thresholdLine1);

            // threshold line 2
            const thresholdLine2 = document.createElement("div");
            thresholdLine2.style.position = "absolute";
            thresholdLine2.style.bottom = thresholdValue * 100 + "%";
            thresholdLine2.style.left = "0px";
            thresholdLine2.style.borderTop = "1px dotted red";
            thresholdLine2.style.height = "1px";
            thresholdLine2.style.width = "100%";
            // thresholdLine2.innerText = thresholdValue;
            // thresholdLine2.innerText.style.top = "20px";
            box.appendChild(thresholdLine2);

            const thresholdDisplay1 = document.createElement("p");
            thresholdDisplay1.style.position = "absolute";
            thresholdDisplay1.style.fontSize = "14px";
            thresholdDisplay1.innerText = "threshold: " + thresholdValue;

            // function percentToPixel(percent) {
            //   return (percent / 100) * (max - min) + min;
            // }
            // thresholdDisplay1.style.marginLeft = percentToPixel(-22) + "px";
            thresholdDisplay1.style.marginLeft = "-22%";

            thresholdDisplay1.style.top = thresholdValue * 100 + "%";
            // thresholdDisplay1.style.color = "green";
            thresholdLine1.appendChild(thresholdDisplay1);

            const thresholdDisplay2 = document.createElement("p");
            thresholdDisplay2.style.position = "absolute";
            thresholdDisplay2.style.fontSize = "14px";
            thresholdDisplay2.innerText = "threshold: " + thresholdValue;
            thresholdDisplay2.style.marginLeft = "-22%";
            thresholdLine2.appendChild(thresholdDisplay2);

            // var iconselect = document.getElementById(target);
            // var emoticonbtn = document.getElementById(box);
            // var oTop = emoticonbtn.offsetTop;
            // var oLeft = emoticonbtn.offsetLeft;
            // iconselect.style.top = oTop;
            // iconselect.style.left = oLeft;
            // iconselect.style.position = "absolute";
            // myDOMRect.style.border = "1px solid green";
            // entry.boundingClientRect.style.border = "1px solid green";
            // console.log(entry.intersectionRatio);
            // TODO: set threshold value visually on the target element with getBoundingClientRect()
          } else {
            entry.target.classList.remove("visible");
          }
        });
      }

      //   let options = {
      //     root: document.querySelector("#scrollArea"),
      //     rootMargin: "0px",
      //     threshold: 1.0,
      //   };

      // ROOT: The element that is used as the viewport for checking visibility of the target.
      // Must be the ancestor of the target. Defaults to the browser viewport if not specified
      // or if null.

      // ROOTMARGIN: Margin around the root. Can have values similar to the CSS margin property,
      // e.g. "10px 20px 30px 40px" (top, right, bottom, left). The values can be percentages.
      // This set of values serves to grow or shrink each side of the root element's bounding box
      //before computing intersections. Defaults to all zeros.

      // THRESHOLD:  If you want the callback to run every time visibility passes another 25%, you
      // would specify the array [0, 0.25, 0.5, 0.75, 1]. The default is 0 (meaning as soon as even
      // one pixel is visible, the callback will be run). A value of 1.0 means that the threshold isn't
      // considered passed until every pixel is visible.

      const observer = new IntersectionObserver(handleIntersection, options);

      observer.observe(target);
    </script>
  </body>
</html>
